#Odabrati i rekonstruisati deterministički signal opisan prostoperiodičnom kosiunus funkcijom učestanosti 2 Hz korišćenjem učestanosti odabiranja 3 Hz i 4 Hz.
#Prikazati postupak rekonstrukcije sabiranjem kardinalnih sinusa. Posmatrati signal u prve dve sekunde.

import ... 

f = 2
fs1 = 3
fs2 = 4

t = np.arange(0, 2.01, 0.01)
Ts1 = 1/fs1
Ts2 = 1/fs2
ts1 = np.arange(0, 2 + Ts1, Ts1)
ts2 = np.arange(0, 2 + Ts2, Ts2)

sig = np.cos(2 * np.pi * f * t)
sig_s1 = np.cos(2 * np.pi * f * ts1)
sig_s2 = np.cos(2 * np.pi * f * ts2)

plt.figure()
plt.plot(t, sig, 'r')
plt.stem(ts1, sig_s1, use_line_collection='True')
plt.title('Originalni signal i odbirci dobijeni odabiranjem sa frekvencijom 4 Hz')
plt.show()

fig = plt.figure()
plt.plot(t, sig, 'r')
plt.stem(ts2, sig_s2, use_line_collection='True')
plt.title('Originalni signal i odbirci dobijeni odabiranjem sa frekvencijom 3 Hz')
plt.show()

# rekonstrukcija
plt.figure()
plt.stem(ts1, sig_s1, use_line_collection='True')

r1 = np.zeros((len(sig_s1), len(t)))
for i in range(len(sig_s1)):
    r1[i, :] = sig_s1[i] * np.sinc((t - ts1[i]) * fs1)
    plt.plot(t, r1[i, :], linewidth=1)

    # za PyCharm/Spyder
    # plt.pause(1)
    # if i == len(sig_s1)-1:
    #     rek1 = np.sum(r1, axis=0)
    #     plt.plot(t, rek1, 'k', linewidth=3)

rek1 = np.sum(r1, axis=0)
plt.plot(t, rek1, 'k', linewidth=3)
plt.show()

# rekonstrukcija 2
plt.figure()
plt.stem(ts2, sig_s2, 'r', use_line_collection='True')

r2 = np.zeros((len(sig_s2), len(t)))
for i in range(len(sig_s2)):
    r2[i, :] = sig_s2[i] * np.sinc((t - ts2[i]) * fs2)
    plt.plot(t, r2[i, :], linewidth=1)

rek2 = np.sum(r2, axis=0)
plt.plot(t, rek2, 'k', linewidth=3)
plt.show()

plt.figure()
plt.plot(t, sig, linewidth=3)
plt.plot(t, rek1, 'r', linewidth=3)
plt.plot(t, rek2, 'k', linewidth=3)
plt.title('Izgled originalnog signala (plava boja) i signala dobijenih rekonstrukcijom na osnovu odbiraka dobijenih odabiranjem sa frekvencijom 3 Hz (crvena boja) i 4 Hz (crna boja)')
plt.show()
